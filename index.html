<html>
 <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>CRM-1902 - Parishkaravedika</title>
     
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
     
        <style>

            .wrapper {
                text-align: center;
            }
            
            .button {
                position: absolute;
                top: 45%;
            background-color:#5068c2;
            }
            
            .topnav {
              overflow: hidden;
             background-color:#5068c2;
            
            
            }
            
            .topnav a {
              float: left;
              display: block;
              color: #eee;
              text-align: center;
              padding: 14px 16px;
              text-decoration: none;
              font-size: 14px;
            }
            
            .topnav a:hover {
              background-color:  #13a9f3;
              color: #eee;
            }
            
            .topnav a.active {
              background-color:#13a9f3;
              color: #eee;;
            }
            
            .topnav .search-container {
              float: right;
            }
            
            .topnav input[type=text] {
              padding: 6px;
              margin-top: 8px;
              font-size: 17px;
              border: none;
            }
            
            .topnav .search-container button {
              float: right;
              padding: 6px 10px;
              margin-top: 8px;
              margin-right: 16px;
              background: #ddd;
              font-size: 17px;
              border: none;
              cursor: pointer;
            }
            
            .topnav .search-container button:hover {
              background: #ccc;
            }
            
            .navbar-right {
                float: right!important;
                margin-right: -1px;
            }
            
            
             
            .footer {
               position: fixed;
            
               left: 0;
               right:10;
               bottom: 0;
               width: 100%;
            height: 36px;
              background-color: #3f55af;
                color: #d9edf7;
               text-align: center;
            }
            
            
            </style>
  </head>
  <div class="topnav">
    <div style="float:left;width:15%;overflow:hidden"> <img class="logo" src="logo-white.PNG" alt="My_Logo"></div>
   <ul class="nav navbar-nav navbar-right">
  
              <li><a href="#" id="loginLink">Log in</a></li>
          </ul>
  
   
  
  </div>
  <body>
 
          <div class="container">
       
            <div class="st-panel">
                <h4>CRM Dispositions</h4>
 
                <form  method="post" name="form1" id="form1">
             
        <div class="row">
            
                 
                <div class="col-md-6  mb-3 form-group">
                    <label>Agent ID</label>
                   <input class="form-control" id="AgentId" name="AgentId" required="required" type="text" value="" />
            </div>
        
            
                
            <div class="col-md-6  col-sm-12 form-group">
                <label>Campaign</label>

                     <input id="CampaignName" name="CampaignName" type="hidden" value="" />
                
                <select class="form-control" data-val="true" data-val-number="The field CampaignId must be a number." data-val-required="The CampaignId field is required." id="CampaignId" name="CampaignId" ><option value="">Select Campaign</option>
            <option value="1">Navaratnalu - 1902</option>
            <option value="2">Spandana - 1100</option>
            <option value="4">Agriculture - 1907</option>
            <option value="5">ACB - 14400</option>
            <option value="6">Sand - 14500</option>
            </select> 
        </div>
    
         </div>
         
                 
    <div class="row">
        <div class="col-md-6 mb-3 form-group">
            <label>Mobile No</label>
                 
                     <input type="text" class="form-control" id="MobileNumber" name="MobileNumber" required pattern="[6-9]{1}[0-9]{9}"
                           title="Phone number with 6-9 and remaing 9 digit with 0-9">
          </div>
    
            <div class="col-md-6 mb-3 form-group">      
                <label class='required' for="password">Call No</label>
                         <input class="form-control text-box single-line" id="CallNumber" name="CallNumber" type="text" value="" />
             </div>
    </div>
    
    <div class="row">
        <div class="col-md-6 mb-3 form-group">
            <label>Disposition</label>
                      <select name="Disposition" id="Disposition" class="form-control">
                        <option value="Answered" selected>Answered</option>
                        <option value="Callback">Callback</option>
                        <option value="Calldrop">Calldrop</option>
                        <option value="For different campaign">For different campaign</option>
                        <option value="New grievance registered">New grievance registered</option>
                        <option value="No voice post answer the call">No voice post answer the call</option>
                    </select>
             </div>		
      
     
    
             <div class="col-md-6 mb-3 form-group">
                <label>District</label>
                        <input id="DistrictName" name="DistrictName" type="hidden" value="" />
                    <select class="form-control" data-val="true" data-val-number="The field DistrictId must be a number." data-val-required="The DistrictId field is required." id="DistrictId" name="DistrictId" onchange="Districts()"><option value="">Select District</option>
					</select>
                </div>
    </div>       

    <div class="row">
        <div class="col-md-6 mb-3 form-group">
          <label>Mandal</label>
               
                <input id="TehsilName" name="TehsilName" type="hidden" value="" />
                     <select class="form-control" data-val="true" data-val-number="The field TehsilId must be a number." data-val-required="The TehsilId field is required." id="TehsilId" name="TehsilId" onchange="Villages()"><option value="">Select Mandal</option>
    </select>
                </div>
             
     
     
<div class="col-md-6 mb-3 form-group">
    <label>Village</label>
             <input id="VillageName" name="VillageName" type="hidden" value="" />
        <select class="form-control" data-val="true" data-val-number="The field VillageId must be a number." data-val-required="The VillageId field is required." id="VillageId" name="VillageId"><option value="">Select Village</option>
    </select>
               
    </div>	
</div>   
      
<div class="row">
	


    <div class="col-md-6 mb-3 form-group">
    
          <label>Department</label>
             <input id="DepartmentName" name="DepartmentName" type="hidden" value="" />
                     <select class="form-control" data-val="true" data-val-number="The field DepartmentId must be a number." data-val-required="The DepartmentId field is required." id="DepartmentId" name="DepartmentId" onchange="Departments()" >
					 <option value="">Select Department</option>
                    </select>
     </div>
         
     <div class="col-md-6 mb-3 form-group">
          <label>HOD</label>
              
            <input id="HodName" name="HodName" type="hidden" value="" />
                     <select class="form-control" data-val="true" data-val-number="The field HodId must be a number." data-val-required="The HodId field is required." id="HodId" name="HodId" onchange="Hods()" required="required" ><option value="">Select HOD</option>
    </select>
    </div>
    </div>
   
    <div class="row">
	
        <div class="col-md-6 mb-3 form-group">
              <label>Subject</label>
                  <input id="SubjectName" name="SubjectName" type="hidden" value="" />
                     <select class="form-control" data-val="true" data-val-number="The field SubjectId must be a number." data-val-required="The SubjectId field is required." id="SubjectId" name="SubjectId" onchange="Subjects()" required="required" ><option value="">Select Subject</option>
                    </select>
                </div>
                <div class="col-md-6 mb-3 form-group">
                    <label>SubSubject</label>
              <input id="SubSubjectName" name="SubSubjectName" type="hidden" value="" />
                     <select class="form-control" data-val="true" data-val-number="The field SubSubjectId must be a number." data-val-required="The SubSubjectId field is required." id="SubSubjectId" name="SubSubjectId" required="required" ><option value="">Select SubSubject</option>
               </select>
                </div>
    </div>
     
    <div class="row">
        <div class="col-md-6 mb-3 form-group">
          <label  for="usertype">Remarks</label>
                     <input class="form-control text-box single-line" id="Remarks" name="Remarks" type="text" value="" />
                    <span class="field-validation-valid text-danger" data-valmsg-for="Remarks" data-valmsg-replace="true"></span>
        </div>
    
    <div class="col-md-6  mb-3 form-group text-right">
               <input type="submit" id="submit" name="submit" value="SUBMIT" class="btn btn-primary" />
    </div>
    </div>

     </form>
    
     </div>
     </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
          
         <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"> -->
         <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
         <!-- <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
          <link href="/portal/Styles/sweetalert.css" rel="stylesheet" />
         <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-sweetalert/1.0.1/sweetalert.css" />
     -->
        
        <script>	
    
            function Districts() {
                var Id = $('#DistrictId').val();
                $.ajax({
                    url: 'https://parishkaravedika.azurewebsites.net/api/CallMandalMaster?districtId='+Id,
                    type: "GET",
                    dataType: "JSON",
                    data: { },
                    success: function (tehsils) {
                        $("#TehsilId").html("");
    
                        $("#TehsilId").append(
                            $('<option></option>').val("").html("Select Mandal"));
    
                        $.each(tehsils, function (i, tehsil) {
                            $("#TehsilId").append(
                                $('<option></option>').val(tehsil.TehsilId).html(tehsil.TehsilName));
    
                        });
                    }
                });
            }
    
            // //function Constituencies() {
            // //    var Id = $('#ConstituencyId').val();
            // //    $.ajax({
            // //        url: '/portal/CallMaster/Masters',
            // //        type: "GET",
            // //        dataType: "JSON",
            // //        data: { constituencyId: Id },
            // //        success: function (tehsils) {
            // //            $("#TehsilId").html("");
    
            // //            $("#TehsilId").append(
            // //                $('<option></option>').val("").html("Select Tehsil"));
    
            // //            $.each(tehsils, function (i, tehsil) {
            // //                $("#TehsilId").append(
            // //                    $('<option></option>').val(tehsil.Id).html(tehsil.Name));
            // //            });
            // //        }
            // //    });
            // //}
    
            function Villages() {
                var tehsilId = $('#TehsilId').val();
                $.ajax({
                    url: 'https://parishkaravedika.azurewebsites.net/api/CallVillageMaster?mandalId='+tehsilId,
                    type: "GET",
                    dataType: "JSON",
                    data: {  },
                    success: function (villages) {
                        $("#VillageId").html("");
    
                        $("#VillageId").append(
                            $('<option></option>').val("").html("Select Village"));
    
                        $.each(villages, function (i, village) {
                            $("#VillageId").append(
                                $('<option></option>').val(village.VillageId).html(village.VillageName));
                        });
                    }
                });
            }
    
    
    
    
    
            function Departments() {
                var departmentId = $('#DepartmentId').val();
                $.ajax({
                    url: 'https://parishkaravedika.azurewebsites.net/api/CallHODMaster?departmentId='+departmentId,
                    type: "GET",
                    dataType: "JSON",
                    data: { },
                    success: function (hods) {
                        $("#HodId").html("");
    
                        $("#HodId").append(
                            $('<option></option>').val("").html("Select HOD"));
    
                        $.each(hods, function (i, hod) {
                            $("#HodId").append(
                                $('<option></option>').val(hod.Id).html(hod.Name));
    
                        });
                    }
                });
            }
    
            function Hods() {
                var hodId = $('#HodId').val();
                $.ajax({
                    url: 'https://parishkaravedika.azurewebsites.net/api/CallSubjectMaster?hodId='+hodId,
                    type: "GET",
                    dataType: "JSON",
                    data: { },
                    success: function (subjects) {
                        $("#SubjectId").html("");
    
                        $("#SubjectId").append(
                            $('<option></option>').val("").html("Select Subject"));
    
                        $.each(subjects, function (i, subject) {
                            $("#SubjectId").append(
                                $('<option></option>').val(subject.Id).html(subject.Name));
                        });
                    }
                });
            }
    
            function Subjects() {
                var subjectId = $('#SubjectId').val();
                $.ajax({
                    url: 'https://parishkaravedika.azurewebsites.net/api/CallSubSubjecMaster?subjectId='+subjectId,
                    type: "GET",
                    dataType: "JSON",
                    data: { },
                    success: function (subsubjects) {
                        $("#SubSubjectId").html("");
    
                        $("#SubSubjectId").append(
                            $('<option></option>').val("").html("Select SubSubject"));
    
                        $.each(subsubjects, function (i, subsubject) {
                            $("#SubSubjectId").append(
                                $('<option></option>').val(subsubject.Id).html(subsubject.Name));
                        });
                    }
                });
            }
    
    
	       function getDepartmentMaster() {
                
                $.ajax({
                    url: 'https://parishkaravedika.azurewebsites.net/api/CallDepartmentMaster',
                    type: "GET",
                    dataType: "JSON",
                    data: { },
                    success: function (departments) {
                        $("#DepartmentId").html("");
    
                        $("#DepartmentId").append(
                            $('<option></option>').val("").html("Select Department"));
    
                        $.each(departments, function (i, department) {
                            $("#DepartmentId").append(
                                $('<option></option>').val(department.Id).html(department.Name));
                        });
                    }
                });
            }
			
    
			function getDistrictMaster() {
                
                $.ajax({
                    url: 'https://parishkaravedika.azurewebsites.net/api/CallDistrictMaster',
                    type: "GET",
                    dataType: "JSON",
                    data: { },
                    success: function (districts) {
                        $("#DistrictId").html("");
    
                        $("#DistrictId").append(
                            $('<option></option>').val("").html("Select District"));
    
                        $.each(districts, function (i, district) {
                            $("#DistrictId").append(
                                $('<option></option>').val(district.districtid).html(district.districtname));
                        });
                    }
                });
            }
			
	
            function StoreDisposition() {
            
                var dataObj = {
                        "AgentId":$('#AgentId').val(),
                        "CampaignId": $('#CampaignId').val(),
                        "MobileNumber": $('#MobileNumber').val(),
                        "CallNumber": $('#CallNumber').val(),
                        "Disposition": $('#Disposition').val(),
                        "DistrictId": $('#DistrictId').val(),
                        "TehsilId": $('#TehsilId').val(),
                        "VillageId":  $('#VillageId').val(),
                        "DepartmentId":  $('#DepartmentId').val(),
                        "HodId":  $('#HodId').val(),
                        "SubjectId":$('#SubjectId').val(),
                        "SubSubjectId": $('#SubSubjectId').val(),
                        "Remarks": $('#Remarks').val()
                }
    
                checkForStaffMemebership(dataObj);
     
                 
            }
    
            function checkForStaffMemebership(dataObj) {
            return new Promise(function (resolve, reject) {
            $.ajax({
                url: 'https://parishkaravedika.azurewebsites.net/api/addDisposition',
                type: "post",
                dataType: 'json',
                async: false,
                cache: false,
                timeout: 50000,
                contentType: 'application/json',
                data:JSON.stringify(dataObj),
                success: function (data) {
                    alert('Data Saved Successfully');
                    location.reload(true);
       
                },
                error: function(data){
                    alert('Data Saved Successfully!');
                    location.reload(true);
                    
    
                }
            });
        });
        }
    
    
    
            $(function () {
				getDepartmentMaster();
				getDistrictMaster();
	 
					$("#form1").on('submit',function(e){
                        e.preventDefault();
                     // alert("Form submitted");
                     //var $myForm = $('#form1');
                    //  //   alert( $myForm[0].checkValidity());
                    // if(! $myForm[0].checkValidity()) {
                    // // If the form is invalid, submit it. The form won't actually submit;
                    // // this will just cause the browser to display the native HTML5 error messages.
                    //     //$myForm.find(':submit').click();
                    //     //alert('inside data');
                    // }
                    // alert('after inside data');

                    var campaign = $("#CampaignId option:selected").text();
                    $("#CampaignName").val(campaign);
    
    
                    var district = $("#DistrictId option:selected").text();
                    $("#DistrictName").val(district);
    
                    var tehsil = $("#TehsilId option:selected").text();
                    $("#TehsilName").val(tehsil);
    
                    var village = $("#VillageId option:selected").text();
                    $("#VillageName").val(village);
    
    
    
                    var department = $("#DepartmentId option:selected").text();
                    $("#DepartmentName").val(department);
    
                    var hod = $("#HodId option:selected").text();
                    $("#HodName").val(hod);
    
                    var subject = $("#SubjectId option:selected").text();
                    $("#SubjectName").val(subject);
    
    
                    var subsubject = $("#SubSubjectId option:selected").text();
                    $("#SubSubjectName").val(subsubject);
    
                    StoreDisposition();
    
                });
            });
    
    
    
        </script>
    
    <div class="footer" style="line-height:50px">
        <footer>&copy; Copyright 2020</footer>
        </div>
        
          </body>
        </html>
        
        
     
     
